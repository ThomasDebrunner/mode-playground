<html>
<head>
<script type="text/javascript" src="brython.js"></script>
<script type="text/javascript" src="brython_stdlib.js"></script>
</head>
<body onload="brython()">

    <textarea id="console"></textarea>
    <script type="text/python3">
        import sys
        from browser import document

        class MyOutput:
            def __init__(self):
                self.console = document["console"]

            def write(self, text):
                self.console.text += text

        sys.stdout = MyOutput()

        print("Hello World 1")

        print("Hello World 2")

    </script>

    <script type="text/python">
        from browser import document, window
        from mode_sim.main import Vehicle, apply_command
        from mode_sim.modes import modes_from_dict
        from mode_sim.state import state_from_dict

        import yaml

        with open('../setup.yaml', 'r') as f:
            y = yaml.safe_load(f)

        modes = modes_from_dict(y['Modes'])
        state = state_from_dict(y['State'])
        stacks = y['Stacks']

        vehicle = Vehicle(modes, state, stacks)

        def py_apply_command(arg):
            print(arg)
            return apply_command(vehicle, arg)

        def py_dump_vehicle():
            return vehicle._dump_json()

        window.py_apply_command = py_apply_command
        window.py_dump_vehicle = py_dump_vehicle
    </script>


</body>
</html>